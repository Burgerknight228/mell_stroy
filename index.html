<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MELLSTROY.GAME</title>
<style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif;}
    body{
        background:linear-gradient(135deg,#1a2a6c,#b21f1f,#fdbb2d);
        min-height:100vh;display:flex;justify-content:center;align-items:center;
    }
    .container{
        width:800px;background:rgba(0,0,0,0.75);color:#fff;
        border-radius:20px;padding:20px;box-shadow:0 0 30px rgba(0,0,0,0.5);
    }
    h1{text-align:center;color:#ffcc00;margin-bottom:10px;text-shadow:0 0 10px #ffcc00;}
    .balance-container{
        display:flex;justify-content:space-between;align-items:center;
        background:rgba(0,0,0,0.4);padding:10px 20px;border-radius:10px;margin-bottom:15px;
    }
    .balance{font-size:1.4rem;font-weight:bold;color:#ffcc00;}
    .slot-machine{background:#1a1a2e;border-radius:15px;padding:20px;box-shadow:inset 0 0 15px rgba(0,0,0,0.5);}
    .reels-container{display:flex;justify-content:space-between;}
    .reel{
        width:18%;height:400px;overflow:hidden;background:#000;
        border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,0.5);position:relative;
        transition:filter 0.2s;
    }
    .reel-strip{position:absolute;width:100%;top:0;left:0;}
    .symbol{width:100%;height:100px;display:flex;align-items:center;justify-content:center;}
    .symbol-img{width:80%;height:80%;object-fit:contain;}
    .controls{text-align:center;margin-top:15px;}
    .spin-btn{
        padding:15px 40px;border:none;border-radius:50px;
        background:linear-gradient(145deg,#ffcc00,#ffaa00);
        color:#000;font-weight:bold;font-size:1.2rem;
        cursor:pointer;transition:transform 0.2s;
    }
    .spin-btn:hover{transform:scale(1.05);}
    .spin-btn:disabled{background:#555;color:#999;cursor:not-allowed;}
    .result{text-align:center;margin-top:15px;font-size:1.4rem;color:#ffcc00;}
    .win{animation:pulse 0.5s infinite alternate;}
    @keyframes pulse{from{transform:scale(1);}to{transform:scale(1.1);}}
    .glow img{filter:drop-shadow(0 0 10px gold) drop-shadow(0 0 20px gold);}
</style>
</head>
<body>
<div class="container">
    <h1>MELLSTROY.GAME</h1>
    <div class="balance-container">
        <div class="balance">–ë–∞–ª–∞–Ω—Å: <span id="balance">1000</span> ‚ÇΩ</div>
        <div class="balance">–°—Ç–∞–≤–∫–∞: <span id="bet">50</span> ‚ÇΩ</div>
    </div>

    <div class="slot-machine">
        <div class="reels-container">
            <div class="reel"><div class="reel-strip" id="strip1"></div></div>
            <div class="reel"><div class="reel-strip" id="strip2"></div></div>
            <div class="reel"><div class="reel-strip" id="strip3"></div></div>
            <div class="reel"><div class="reel-strip" id="strip4"></div></div>
            <div class="reel"><div class="reel-strip" id="strip5"></div></div>
        </div>
        <div class="controls">
            <button id="spin-btn" class="spin-btn">–ö–†–£–¢–ò–¢–¨</button>
        </div>
        <div id="result" class="result"></div>
    </div>
</div>

<script>
let balance = 1000;
let bet = 50;
let isSpinning = false;
let spinCount = 0;   // —Å—á—ë—Ç—á–∏–∫ —Å–ø–∏–Ω–æ–≤
const balanceEl = document.getElementById('balance');
const resultEl = document.getElementById('result');

const symbols = [
    {id:1, html:'<img src="sugar bear.png" class="symbol-img">'},
    {id:2, html:'<img src="zues cerber.png" class="symbol-img">'},
    {id:3, html:'<img src="" class="symbol-img">'},
    {id:4, html:'<img src="785e6fe1470966786e0ecff568833a2b.jpg" class="symbol-img">'},
    {id:5, html:'<img src="1023.gif" class="symbol-img">'},
    {id:6, html:'<img src="1022.gif" class="symbol-img">'}
];

function createReels() {
    for (let i=1; i<=5; i++) {
        const strip=document.getElementById(`strip${i}`);
        strip.innerHTML='';
        for (let j=0;j<30;j++){
            const sym=symbols[Math.floor(Math.random()*symbols.length)];
            const el=document.createElement('div');
            el.className='symbol';
            el.innerHTML=sym.html;
            strip.appendChild(el);
        }
    }
}

document.addEventListener('DOMContentLoaded',()=>{
    createReels();
    document.getElementById('spin-btn').addEventListener('click',startSpin);
});

function startSpin(){
    if(isSpinning) return;
    if(balance < bet){
        resultEl.textContent="–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!";
        return;
    }
    isSpinning=true;
    spinCount++;
    resultEl.textContent="";
    balance -= bet;
    balanceEl.textContent = balance;

    const reels=[
        document.getElementById('strip1'),
        document.getElementById('strip2'),
        document.getElementById('strip3'),
        document.getElementById('strip4'),
        document.getElementById('strip5')
    ];

    reels.forEach((r,i)=>{
        spinReel(r, 700 + i*100, i*80, i===reels.length-1);
    });
}

// –ë—ã—Å—Ç—Ä–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑
function spinReel(reel, duration, delay, isLast=false){
    const symbolHeight=100;

    setTimeout(()=>{
        let position=0;
        let start=performance.now();
        let lastFrame=start;

        function animate(time){
            let elapsed=time-start;
            let delta=time-lastFrame;
            lastFrame=time;

            const progress = Math.min(elapsed / duration, 1);
            const speedFactor = (1 - Math.pow(progress, 2)); 

            position += delta * 2.5 * speedFactor;
            if(position >= symbolHeight){
                position -= symbolHeight;
                reel.appendChild(reel.firstElementChild);
            }
            reel.style.transform=`translateY(${position}px)`;

            if(progress < 1){
                requestAnimationFrame(animate);
            } else {
                reel.style.transform='translateY(0)';
                if(isLast) finishSpin();
            }
        }

        requestAnimationFrame(animate);
    }, delay);
}

function finishSpin(){
    document.querySelectorAll('.symbol.glow').forEach(el=>el.classList.remove('glow'));

    // –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à –Ω–∞ –∫–∞–∂–¥–æ–º 5-–º —Å–ø–∏–Ω–µ
    const guaranteedWin = spinCount % 5 === 0;
    let win=0;

    if(guaranteedWin){
        // –ó–∞–º–µ–Ω—è–µ–º —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –Ω–∞ JACKPOT
        for(let i=1;i<=5;i++){
            const strip=document.getElementById(`strip${i}`);
            const symbolsEls=strip.getElementsByClassName('symbol');
            symbolsEls[8].innerHTML=symbols[5].html; // JACKPOT
            symbolsEls[8].classList.add('glow');
        }
        win=bet*20;
        balance+=win;
        resultEl.textContent=`üî• –î–∂–µ–∫–ø–æ—Ç! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${win} ‚ÇΩ!`;
        resultEl.classList.add('win');
    } else {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—ã—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
        const centers=[];
        for(let i=1;i<=5;i++){
            const strip=document.getElementById(`strip${i}`);
            const symbolsEls=strip.getElementsByClassName('symbol');
            centers.push(symbolsEls[8].querySelector('img').src);
        }
        const allEqual=centers.every(src=>src===centers[0]);
        if(allEqual){
            win=bet*10;
            balance+=win;
            resultEl.textContent=`–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${win} ‚ÇΩ!`;
            resultEl.classList.add('win');
            for(let i=1;i<=5;i++){
                const strip=document.getElementById(`strip${i}`);
                const symbolsEls=strip.getElementsByClassName('symbol');
                symbolsEls[8].classList.add('glow');
            }
        }else{
            resultEl.textContent="–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑!";
            resultEl.classList.remove('win');
        }
    }
    balanceEl.textContent=balance;
    isSpinning=false;
}
</script>
</body>
</html>
