<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Слот-машина с вертикальным вращением</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #1f1632, #190127);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            width: 100%;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            color: white;
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        h1 {
            font-size: 2.5rem;
            color: #ffffff;
            text-shadow: 0 0 10px rgba(255, 204, 0, 0.7);
            margin-bottom: 10px;
        }
        
        .balance-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .balance {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffcc00;
        }
        
        .bet-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .bet-btn {
            background: #ffcc00;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .bet-btn:hover {
            background: #ffdd44;
            transform: scale(1.1);
        }
        
        .bet-amount {
            font-size: 1.2rem;
            font-weight: bold;
            min-width: 60px;
            text-align: center;
        }
        
        .slot-machine {
            background: linear-gradient(145deg, #2c3e50, #34495e);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
        }
        
        .reels-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            position: relative;
            height: 300px;
        }
        
        .reel {
            width: 18%;
            height: 100%;
            background: #1a1a2e;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }
        
        .reel-strip {
            position: absolute;
            width: 100%;
            top: 0;
            transition: top 0.5s ease-out;
        }
        
        .symbol {
            width: 100%;
            height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .symbol-img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }
        
        .win-line {
            position: absolute;
            left: 0;
            width: 100%;
            height: 3px;
            background: #ffcc00;
            box-shadow: 0 0 10px #ffcc00;
            z-index: 10;
            opacity: 0;
        }
        
        .win-line-1 { top: 20%; }
        .win-line-2 { top: 50%; }
        .win-line-3 { top: 80%; }
        
        .reel-mask {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                rgba(26, 26, 46, 0.9) 0%,
                rgba(26, 26, 46, 0) 15%,
                rgba(26, 26, 46, 0) 85%,
                rgba(26, 26, 46, 0.9) 100%
            );
            pointer-events: none;
            z-index: 5;
        }
        
        .win-lines {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .line {
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .line.active {
            background: #ffcc00;
            color: #000;
            font-weight: bold;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        
        .spin-btn {
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: bold;
            background: linear-gradient(145deg, #ffcc00, #ffaa00);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .spin-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 7px 20px rgba(0, 0, 0, 0.4);
        }
        
        .spin-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .result {
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            min-height: 40px;
            margin-top: 15px;
            color: #ffcc00;
            text-shadow: 0 0 5px rgba(255, 204, 0, 0.5);
        }
        
        .win-animation {
            animation: winPulse 0.5s infinite alternate;
        }
        
        @keyframes winPulse {
            from { transform: scale(1); }
            to { transform: scale(1.05); }
        }
        
        .slow-reel {
            transition: top 1.5s ease-out !important;
        }
        
        .win-line.active {
            animation: lineBlink 0.5s infinite alternate;
            opacity: 1;
        }
        
        @keyframes lineBlink {
            from { opacity: 1; }
            to { opacity: 0.3; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>MELLSTROY.GAME</h1>
            <p>Пять линий для выигрыша. Удачи!</p>
        </header>
        
        <div class="balance-container">
            <div class="balance">Баланс: <span id="balance">1000</span> ₽</div>
            <div class="bet-controls">
                <button class="bet-btn" id="decrease-bet">-</button>
                <div class="bet-amount">Ставка: <span id="bet-amount">10</span> ₽</div>
                <button class="bet-btn" id="increase-bet">+</button>
            </div>
        </div>
        
        <div class="slot-machine">
            <div class="reels-container">
                <div class="win-line win-line-1" id="win-line-1"></div>
                <div class="win-line win-line-2" id="win-line-2"></div>
                <div class="win-line win-line-3" id="win-line-3"></div>
                
                <div class="reel" id="reel1">
                    <div class="reel-strip" id="strip1"></div>
                    <div class="reel-mask"></div>
                </div>
                <div class="reel" id="reel2">
                    <div class="reel-strip" id="strip2"></div>
                    <div class="reel-mask"></div>
                </div>
                <div class="reel" id="reel3">
                    <div class="reel-strip" id="strip3"></div>
                    <div class="reel-mask"></div>
                </div>
                <div class="reel" id="reel4">
                    <div class="reel-strip" id="strip4"></div>
                    <div class="reel-mask"></div>
                </div>
                <div class="reel" id="reel5">
                    <div class="reel-strip" id="strip5"></div>
                    <div class="reel-mask"></div>
                </div>
            </div>
            
            <div class="win-lines">
                <div class="line active" data-line="1">Линия 1</div>
                <div class="line active" data-line="2">Линия 2</div>
                <div class="line active" data-line="3">Линия 3</div>
                <div class="line active" data-line="4">Линия 4</div>
                <div class="line active" data-line="5">Линия 5</div>
            </div>
            
            <div class="controls">
                <button class="spin-btn" id="spin-btn">КРУТИТЬ</button>
            </div>
            
            <div class="result" id="result"></div>
        </div>
    </div>

    <script>
        // Инициализация переменных
        let balance = 1000;
        let currentBet = 10;
        let isSpinning = false;
        let activeLines = [1, 2, 3, 4, 5];
        const symbolHeight = 100;
        const visibleSymbols = 3; // Количество видимых символов в барабане
        
        // Символы для слотов с изображениями
        // ЗАМЕНИТЕ ССЫЛКИ НА ПУТИ К ВАШИМ ИЗОБРАЖЕНИЯМ
        const symbols = [
            { 
                id: 1, 
                name: "Вишня", 
                multiplier: 2, 
                html: '<img src="785e6fe1470966786e0ecff568833a2b.jpg" class="symbol-img" alt="Апельсин">'
            },
            { 
                id: 2, 
                name: "Лимон", 
                multiplier: 3, 
                html: '<img src="1022.gif" class="symbol-img" alt="Вишня">'  
            },
            { 
                id: 3, 
                name: "Апельсин", 
                multiplier: 4, 
                html: '<img src="https://via.placeholder.com/80x80/FFA500/FFFFFF?text=ORANGE" class="symbol-img" alt="Апельсин">' 
            },
            { 
                id: 4, 
                name: "Семь", 
                multiplier: 5, 
                html: '<img src="https://via.placeholder.com/80x80/FFFFFF/000000?text=7" class="symbol-img" alt="Семь">' 
            },
            { 
                id: 5, 
                name: "Бар", 
                multiplier: 10, 
                html: '<img src="https://via.placeholder.com/80x80/0000FF/FFFFFF?text=BAR" class="symbol-img" alt="Бар">' 
            },
            { 
                id: 6, 
                name: "Звезда", 
                multiplier: 15, 
                html: '<img src="https://via.placeholder.com/80x80/FFFF00/000000?text=STAR" class="symbol-img" alt="Звезда">' 
            },
            { 
                id: 7, 
                name: "Джекпот", 
                multiplier: 50, 
                html: '<img src="https://via.placeholder.com/80x80/FFD700/000000?text=JACKPOT" class="symbol-img" alt="Джекпот">' 
            }
        ];
        
        // Инициализация игры
        document.addEventListener('DOMContentLoaded', function() {
            initializeGame();
            setupEventListeners();
        });
        
        // Инициализация игрового поля
        function initializeGame() {
            updateBalanceDisplay();
            updateBetDisplay();
            createReelStrips();
            
            // Активируем все линии по умолчанию
            document.querySelectorAll('.line').forEach(line => {
                line.classList.add('active');
            });
        }
        
        // Создание полосок с символами для каждого барабана
        function createReelStrips() {
            for (let i = 1; i <= 5; i++) {
                const strip = document.getElementById(`strip${i}`);
                strip.innerHTML = '';
                
                // Создаем достаточно символов для бесконечного вращения
                // 15 символов = 5 видимых + 10 для плавного вращения
                for (let j = 0; j < 15; j++) {
                    const randomSymbol = symbols[Math.floor(Math.random() * symbols.length)];
                    const symbolElement = document.createElement('div');
                    symbolElement.className = 'symbol';
                    symbolElement.innerHTML = randomSymbol.html;
                    symbolElement.dataset.symbolId = randomSymbol.id;
                    strip.appendChild(symbolElement);
                }
                
                // Устанавливаем начальную позицию - показываем первые 3 символа
                strip.style.top = '0px';
            }
        }
        
        // Настройка обработчиков событий
        function setupEventListeners() {
            document.getElementById('spin-btn').addEventListener('click', startSpin);
            document.getElementById('increase-bet').addEventListener('click', increaseBet);
            document.getElementById('decrease-bet').addEventListener('click', decreaseBet);
            
            // Обработчики для линий
            document.querySelectorAll('.line').forEach(line => {
                line.addEventListener('click', function() {
                    toggleLine(parseInt(this.dataset.line));
                });
            });
        }
        
        // Увеличение ставки
        function increaseBet() {
            if (isSpinning) return;
            
            const betValues = [10, 20, 50, 100];
            const currentIndex = betValues.indexOf(currentBet);
            
            if (currentIndex < betValues.length - 1) {
                currentBet = betValues[currentIndex + 1];
                updateBetDisplay();
            }
        }
        
        // Уменьшение ставки
        function decreaseBet() {
            if (isSpinning) return;
            
            const betValues = [10, 20, 50, 100];
            const currentIndex = betValues.indexOf(currentBet);
            
            if (currentIndex > 0) {
                currentBet = betValues[currentIndex - 1];
                updateBetDisplay();
            }
        }
        
        // Переключение активной линии
        function toggleLine(lineNumber) {
            if (isSpinning) return;
            
            const lineIndex = activeLines.indexOf(lineNumber);
            const lineElement = document.querySelector(`.line[data-line="${lineNumber}"]`);
            
            if (lineIndex === -1) {
                activeLines.push(lineNumber);
                lineElement.classList.add('active');
            } else {
                activeLines.splice(lineIndex, 1);
                lineElement.classList.remove('active');
            }
        }
        
        // Обновление отображения баланса
        function updateBalanceDisplay() {
            document.getElementById('balance').textContent = balance;
        }
        
        // Обновление отображения ставки
        function updateBetDisplay() {
            document.getElementById('bet-amount').textContent = currentBet;
        }
        
        // Запуск вращения барабанов
        function startSpin() {
            if (isSpinning) return;
            
            const totalBet = currentBet * activeLines.length;
            
            if (balance < totalBet) {
                showResult("Недостаточно средств!");
                return;
            }
            
            // Снимаем ставку
            balance -= totalBet;
            updateBalanceDisplay();
            
            isSpinning = true;
            document.getElementById('spin-btn').disabled = true;
            document.getElementById('result').textContent = '';
            document.getElementById('result').classList.remove('win-animation');
            
            // Скрываем линии выигрыша
            document.querySelectorAll('.win-line').forEach(line => {
                line.classList.remove('active');
            });
            
            // Определяем, будет ли выигрыш (для демонстрации)
            const willWin = Math.random() > 0.7;
            
            // Запускаем вращение барабанов по очереди
            spinReelsSequentially(willWin);
        }
        
        // Вращение барабанов по очереди
        function spinReelsSequentially(willWin) {
            const reels = [
                document.getElementById('strip1'),
                document.getElementById('strip2'),
                document.getElementById('strip3'),
                document.getElementById('strip4'),
                document.getElementById('strip5')
            ];
            
            const spinDuration = 800; // Длительность вращения одного барабана
            const delayBetweenReels = 300; // Задержка между запуском барабанов
            
            // Сбрасываем класс медленного вращения
            reels.forEach(reel => reel.classList.remove('slow-reel'));
            
            // Запускаем вращение для каждого барабана с задержкой
            for (let i = 0; i < reels.length; i++) {
                const isLastReel = (i === reels.length - 1);
                const reelWillWin = isLastReel && willWin;
                
                setTimeout(() => {
                    if (reelWillWin) {
                        reels[i].classList.add('slow-reel');
                        spinReel(reels[i], spinDuration * 2, isLastReel, reelWillWin);
                    } else {
                        spinReel(reels[i], spinDuration, isLastReel, reelWillWin);
                    }
                }, i * delayBetweenReels);
            }
        }
        
        // Вращение одного барабана
        function spinReel(reel, duration, isLast = false, willWin = false) {
            // Вычисляем конечную позицию
            const currentPosition = parseInt(reel.style.top) || 0;
            const spinDistance = willWin ? 
                -symbolHeight * 8 : // Для выигрышного вращения - большее расстояние
                -symbolHeight * (5 + Math.floor(Math.random() * 5)); // Случайное расстояние
            
            const finalPosition = currentPosition + spinDistance;
            
            // Анимация вращения
            reel.style.transition = `top ${duration}ms cubic-bezier(0.2, 0.7, 0.3, 1)`;
            reel.style.top = `${finalPosition}px`;
            
            // По завершении вращения
            setTimeout(() => {
                // Если достигли конца ленты, сбрасываем позицию
                const totalHeight = reel.children.length * symbolHeight;
                const visibleHeight = visibleSymbols * symbolHeight;
                
                if (Math.abs(finalPosition) >= totalHeight - visibleHeight) {
                    // Сбрасываем позицию без анимации
                    reel.style.transition = 'none';
                    reel.style.top = '0px';
                    
                    // Применяем остаток смещения
                    setTimeout(() => {
                        const remainder = finalPosition + (totalHeight - visibleHeight);
                        reel.style.transition = `top ${duration}ms cubic-bezier(0.2, 0.7, 0.3, 1)`;
                        reel.style.top = `${remainder}px`;
                    }, 50);
                }
                
                if (isLast) {
                    // Даем время на завершение всех анимаций
                    setTimeout(() => {
                        checkWin();
                        isSpinning = false;
                        document.getElementById('spin-btn').disabled = false;
                    }, 500);
                }
            }, duration);
        }
        
        // Проверка выигрышных комбинаций
        function checkWin() {
            const reels = [
                document.getElementById('strip1'),
                document.getElementById('strip2'),
                document.getElementById('strip3'),
                document.getElementById('strip4'),
                document.getElementById('strip5')
            ];
            
            // Получаем символы на каждой линии
            const lineSymbols = {
                1: [], // Верхняя линия
                2: [], // Средняя линия
                3: [], // Нижняя линия
                4: [], // Диагональ 1
                5: []  // Диагональ 2
            };
            
            // Заполняем символы для каждой линии
            for (let i = 0; i < 5; i++) {
                const reel = reels[i];
                const symbols = reel.getElementsByClassName('symbol');
                const currentTop = Math.abs(parseInt(reel.style.top)) || 0;
                const symbolIndex = Math.floor(currentTop / symbolHeight);
                
                // Верхняя линия (первый видимый символ)
                lineSymbols[1].push(parseInt(symbols[symbolIndex % symbols.length].dataset.symbolId));
                // Средняя линия (второй видимый символ)
                lineSymbols[2].push(parseInt(symbols[(symbolIndex + 1) % symbols.length].dataset.symbolId));
                // Нижняя линия (третий видимый символ)
                lineSymbols[3].push(parseInt(symbols[(symbolIndex + 2) % symbols.length].dataset.symbolId));
                
                // Диагональные линии
                if (i === 0) {
                    lineSymbols[4].push(parseInt(symbols[symbolIndex % symbols.length].dataset.symbolId));
                    lineSymbols[5].push(parseInt(symbols[(symbolIndex + 2) % symbols.length].dataset.symbolId));
                } else if (i === 1) {
                    lineSymbols[4].push(parseInt(symbols[(symbolIndex + 1) % symbols.length].dataset.symbolId));
                    lineSymbols[5].push(parseInt(symbols[(symbolIndex + 1) % symbols.length].dataset.symbolId));
                } else if (i === 2) {
                    lineSymbols[4].push(parseInt(symbols[(symbolIndex + 2) % symbols.length].dataset.symbolId));
                    lineSymbols[5].push(parseInt(symbols[symbolIndex % symbols.length].dataset.symbolId));
                } else if (i === 3) {
                    lineSymbols[4].push(parseInt(symbols[(symbolIndex + 1) % symbols.length].dataset.symbolId));
                    lineSymbols[5].push(parseInt(symbols[(symbolIndex + 1) % symbols.length].dataset.symbolId));
                } else if (i === 4) {
                    lineSymbols[4].push(parseInt(symbols[symbolIndex % symbols.length].dataset.symbolId));
                    lineSymbols[5].push(parseInt(symbols[(symbolIndex + 2) % symbols.length].dataset.symbolId));
                }
            }
            
            let totalWin = 0;
            let winningLines = [];
            
            // Проверяем выигрышные комбинации для активных линий
            activeLines.forEach(line => {
                const lineWin = checkLineWin(line, lineSymbols[line]);
                if (lineWin > 0) {
                    totalWin += lineWin;
                    winningLines.push(line);
                }
            });
            
            // Подсвечиваем выигрышные линии
            winningLines.forEach(line => {
                if (line <= 3) {
                    document.getElementById(`win-line-${line}`).classList.add('active');
                }
            });
            
            // Обновляем баланс и показываем результат
            if (totalWin > 0) {
                balance += totalWin;
                updateBalanceDisplay();
                showResult(`Вы выиграли ${totalWin} ₽!`, true);
            } else {
                showResult("Попробуйте еще раз!");
            }
        }
        
        // Проверка выигрыша на конкретной линии
        function checkLineWin(line, symbols) {
            // Проверяем комбинации
            // Для простоты считаем выигрышем 3 и более одинаковых символа подряд
            let winMultiplier = 0;
            
            // Проверяем слева направо
            let count = 1;
            for (let i = 1; i < 5; i++) {
                if (symbols[i] === symbols[0]) {
                    count++;
                } else {
                    break;
                }
            }
            
            if (count >= 3) {
                const symbolData = symbols.find(s => s.id === symbols[0]);
                if (symbolData) {
                    winMultiplier = symbolData.multiplier * Math.pow(2, count - 3);
                }
            }
            
            return currentBet * winMultiplier;
        }
        
        // Показать результат
        function showResult(message, isWin = false) {
            const resultElement = document.getElementById('result');
            resultElement.textContent = message;
            
            if (isWin) {
                resultElement.classList.add('win-animation');
            }
        }
    </script>
</body>
</html>